<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DocPro - Free Document Generator | Invoices, Contracts, Legal Forms</title>
<meta name="description" content="Professional USA Document Generator with 10,000+ templates. Free invoices, receipts, letters. Pro contracts & agreements. Business legal docs.">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0f172a;--sb:#1e293b;--cd:#334155;--ac:#10b981;--tx:#f8fafc;--mt:#94a3b8;--bd:#475569;--er:#ef4444;--warn:#f59e0b;--pro:#6366f1;--biz:#f59e0b}
body{font-family:'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--tx);height:100vh;overflow:hidden}
.hd{display:flex;align-items:center;justify-content:space-between;padding:10px 20px;background:var(--sb);border-bottom:1px solid var(--bd)}
.hd .lg{display:flex;align-items:center;gap:10px}
.li{width:36px;height:36px;background:var(--ac);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:15px;color:var(--bg)}
.hd h1{font-size:18px}.hd .st{font-size:11px;color:var(--mt)}
.hd .ac{display:flex;gap:8px;align-items:center}
.gs{position:relative;width:300px}
.gs input{width:100%;padding:8px 12px 8px 34px;background:var(--cd);border:1px solid var(--bd);border-radius:8px;color:var(--tx);font-size:13px;outline:none;transition:border-color .2s}
.gs input:focus{border-color:var(--ac)}
.gs .si{position:absolute;left:10px;top:50%;transform:translateY(-50%);color:var(--mt);font-size:14px}
.gs .sr{position:absolute;top:100%;left:0;right:0;background:var(--sb);border:1px solid var(--bd);border-radius:0 0 8px 8px;max-height:400px;overflow-y:auto;z-index:999;display:none}
.gs .sr.open{display:block}
.gs .sr .ri{padding:10px 14px;cursor:pointer;font-size:13px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--cd)}
.gs .sr .ri:hover{background:var(--cd)}
.gs .sr .ri .rc{font-size:10px;color:var(--mt);background:var(--bg);padding:2px 6px;border-radius:4px}
.gs .sr .ri .tier-tag{font-size:9px;padding:2px 6px;border-radius:4px;font-weight:700;margin-left:auto}
.tier-free{background:rgba(16,185,129,.2);color:#10b981}
.tier-pro{background:rgba(99,102,241,.2);color:#818cf8}
.tier-biz{background:rgba(245,158,11,.2);color:#f59e0b}
.bt{padding:7px 14px;border-radius:8px;border:none;cursor:pointer;font-size:13px;font-weight:600;display:flex;align-items:center;gap:5px;transition:all .2s}
.b2{background:var(--cd);color:var(--tx)}.b2:hover{background:var(--bd)}
.b1{background:var(--ac);color:var(--bg)}.b1:hover{background:#059669}
.b3{background:#6366f1;color:#fff}.b3:hover{background:#4f46e5}
.b4{background:var(--warn);color:var(--bg)}.b4:hover{background:#d97706}
.b5{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;font-size:12px}.b5:hover{opacity:.9}
.ap{display:flex;height:calc(100vh - 57px)}
.sb{width:280px;min-width:280px;background:var(--sb);overflow-y:auto;padding:14px;border-right:1px solid var(--bd)}
.sb::-webkit-scrollbar{width:5px}.sb::-webkit-scrollbar-thumb{background:var(--bd);border-radius:3px}
.st2{font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;display:flex;align-items:center;gap:6px;color:var(--mt)}
.cg{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:16px}
.cc{background:var(--cd);border:2px solid transparent;border-radius:8px;padding:10px 6px;text-align:center;cursor:pointer;transition:all .2s;font-size:11px;position:relative}
.cc:hover{border-color:var(--ac);transform:translateY(-1px)}
.cc.on{border-color:var(--ac);background:rgba(16,185,129,.1)}
.cc .ic{font-size:20px;margin-bottom:2px;display:block}
.cc .badge{position:absolute;top:4px;right:4px;background:var(--ac);color:var(--bg);font-size:9px;font-weight:700;padding:1px 5px;border-radius:10px;min-width:18px}
.ds{padding:6px 10px;background:var(--cd);border:1px solid var(--bd);border-radius:6px;margin-bottom:8px;display:flex;align-items:center;gap:6px}
.ds input{flex:1;background:none;border:none;color:var(--tx);font-size:12px;outline:none}
.ds input::placeholder{color:var(--bd)}
.tf-row{display:flex;gap:4px;margin-bottom:8px;flex-wrap:wrap}
.tf-btn{padding:3px 10px;border-radius:12px;font-size:10px;cursor:pointer;border:1px solid var(--bd);color:var(--mt);transition:all .2s;font-weight:600;background:none}
.tf-btn:hover{border-color:var(--ac);color:var(--tx)}
.tf-btn.on{background:var(--ac);color:var(--bg);border-color:var(--ac)}
.tf-btn.pro-f{border-color:var(--pro)}.tf-btn.pro-f.on{background:var(--pro)}
.tf-btn.biz-f{border-color:var(--biz)}.tf-btn.biz-f.on{background:var(--biz);color:var(--bg)}
.dl{max-height:250px;overflow-y:auto}
.dl::-webkit-scrollbar{width:4px}.dl::-webkit-scrollbar-thumb{background:var(--bd);border-radius:2px}
.di{padding:8px 10px;border-radius:6px;cursor:pointer;transition:all .2s;font-size:12px;display:flex;align-items:center;gap:7px;margin-bottom:3px}
.di:hover{background:var(--cd)}.di.on{background:var(--ac);color:var(--bg)}
.di .vb{font-size:9px;padding:1px 5px;border-radius:4px;margin-left:auto;white-space:nowrap;font-weight:600}
.di .lock{margin-left:auto;font-size:12px;opacity:.6}
.vp{margin:10px 0;display:flex;gap:4px;flex-wrap:wrap}
.vp .vt{padding:4px 10px;border-radius:12px;font-size:10px;cursor:pointer;border:1px solid var(--bd);color:var(--mt);transition:all .2s;font-weight:600}
.vp .vt:hover{border-color:var(--ac);color:var(--tx)}
.vp .vt.on{background:var(--ac);color:var(--bg);border-color:var(--ac)}
.fg{margin-bottom:10px}
.fg label{display:block;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--mt);margin-bottom:3px}
.fg input,.fg textarea,.fg select{width:100%;padding:7px 9px;background:var(--cd);border:1px solid var(--bd);border-radius:5px;color:var(--tx);font-size:12px;outline:none;transition:border-color .2s}
.fg input:focus,.fg textarea:focus,.fg select:focus{border-color:var(--ac)}
.fg textarea{resize:vertical;min-height:50px}
.mn{flex:1;display:flex;align-items:center;justify-content:center;padding:20px;overflow:auto;background:var(--bg);position:relative}
.pw{width:100%;max-width:850px;min-height:600px;background:#fff;color:#1e293b;border-radius:4px;box-shadow:0 4px 24px rgba(0,0,0,.3);padding:60px;font-size:14px;line-height:1.6;position:relative}
.pw.locked::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(to bottom,transparent 30%,rgba(255,255,255,.95) 60%,#fff 80%);z-index:10;pointer-events:none}
.lock-overlay{position:absolute;bottom:80px;left:50%;transform:translateX(-50%);z-index:11;text-align:center;background:var(--sb);border:1px solid var(--bd);border-radius:16px;padding:32px 48px;box-shadow:0 8px 32px rgba(0,0,0,.4)}
.lock-overlay h3{font-size:20px;margin-bottom:8px}
.lock-overlay p{color:var(--mt);font-size:14px;margin-bottom:16px}
.lock-overlay .price{font-size:28px;font-weight:700;margin-bottom:16px}
.lock-overlay .price span{font-size:14px;font-weight:400;color:var(--mt)}
.dh{text-align:center;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid #e2e8f0}
.dt{font-size:28px;font-weight:700;color:#1e293b}.ds2{color:#64748b;font-size:14px}
.ig{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px}
.ib h4{font-size:11px;text-transform:uppercase;letter-spacing:1px;color:#64748b;margin-bottom:6px}
.ib p{font-size:13px;color:#334155;line-height:1.5}
.pw table{width:100%;border-collapse:collapse;margin:20px 0}
.pw th{background:#f1f5f9;padding:10px 12px;text-align:left;font-size:12px;text-transform:uppercase;letter-spacing:.5px;color:#64748b;border-bottom:2px solid #e2e8f0}
.pw td{padding:10px 12px;border-bottom:1px solid #e2e8f0;font-size:13px}
.tt{text-align:right;margin-top:16px}.tt .rw{display:flex;justify-content:flex-end;gap:40px;padding:4px 0;font-size:14px}
.tt .tf{font-weight:700;font-size:16px;border-top:2px solid #1e293b;padding-top:8px;margin-top:8px}
.nt{margin-top:24px;padding:16px;background:#f8fafc;border-radius:8px;border-left:4px solid #10b981}
.nt h4{font-size:12px;text-transform:uppercase;color:#64748b;margin-bottom:6px}
.sa{margin-top:40px;display:grid;grid-template-columns:1fr 1fr;gap:40px}
.sl{border-top:1px solid #94a3b8;padding-top:8px;margin-top:40px;font-size:12px;color:#64748b}
.pp{text-align:center;padding:60px;color:#94a3b8}
.doc-logo{max-height:60px;max-width:200px;margin-bottom:8px}
/* Modal */
.modal-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:1000;display:none;align-items:center;justify-content:center}
.modal-bg.open{display:flex}
.modal{background:var(--sb);border:1px solid var(--bd);border-radius:12px;padding:24px;max-width:700px;width:90%;max-height:85vh;overflow-y:auto}
.modal h2{font-size:18px;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.modal .close-btn{margin-left:auto;cursor:pointer;font-size:20px;color:var(--mt);background:none;border:none}
.modal .close-btn:hover{color:var(--tx)}
/* Pricing cards */
.pricing-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin:16px 0}
.price-card{border:2px solid var(--bd);border-radius:12px;padding:20px;text-align:center;transition:all .2s;position:relative}
.price-card:hover{border-color:var(--ac);transform:translateY(-2px)}
.price-card.popular{border-color:var(--pro)}
.price-card.popular::before{content:'MOST POPULAR';position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:var(--pro);color:#fff;font-size:10px;font-weight:700;padding:2px 12px;border-radius:10px}
.price-card h3{font-size:20px;margin-bottom:4px}
.price-card .pc-price{font-size:36px;font-weight:700;margin:12px 0}
.price-card .pc-price span{font-size:14px;font-weight:400;color:var(--mt)}
.price-card .pc-feat{text-align:left;font-size:12px;color:var(--mt);margin:12px 0}
.price-card .pc-feat div{padding:4px 0;display:flex;align-items:center;gap:6px}
.price-card .pc-feat .ck{color:var(--ac)}
.price-card .pc-feat .no{color:var(--er);opacity:.4}
/* Logo creator */
.logo-prev{width:200px;height:80px;display:flex;align-items:center;justify-content:center;border:2px dashed var(--bd);border-radius:8px;margin:12px auto;font-size:24px;font-weight:700;background:#fff;color:#1e293b}
.logo-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:12px}
.logo-grid .lg-item{padding:8px;text-align:center;cursor:pointer;border:2px solid transparent;border-radius:8px;transition:all .2s;background:var(--cd)}
.logo-grid .lg-item:hover{border-color:var(--ac)}
.logo-grid .lg-item.sel{border-color:var(--ac);background:rgba(16,185,129,.1)}
.logo-grid .lg-item img{width:48px;height:48px;object-fit:contain}
.logo-grid .lg-item span{display:block;font-size:10px;color:var(--mt);margin-top:4px}
/* Upload */
.upload-zone{border:2px dashed var(--bd);border-radius:12px;padding:40px;text-align:center;cursor:pointer;transition:all .2s;margin:12px 0}
.upload-zone:hover{border-color:var(--ac);background:rgba(16,185,129,.05)}
.upload-zone.drag{border-color:var(--ac);background:rgba(16,185,129,.1)}
/* User plan indicator */
.plan-badge{padding:4px 12px;border-radius:20px;font-size:11px;font-weight:700;cursor:pointer}
.plan-free{background:rgba(16,185,129,.15);color:#10b981;border:1px solid rgba(16,185,129,.3)}
.plan-pro{background:rgba(99,102,241,.15);color:#818cf8;border:1px solid rgba(99,102,241,.3)}
.plan-biz{background:rgba(245,158,11,.15);color:#f59e0b;border:1px solid rgba(245,158,11,.3)}
/* Print */
@media print{.hd,.sb,.lock-overlay{display:none!important}.ap{display:block!important}.mn{padding:0!important}.pw{box-shadow:none!important;max-width:100%!important;padding:40px!important}.pw.locked::after{display:none!important}}
/* Themes */
.pw.theme-modern .dh{border-bottom:3px solid #10b981}.pw.theme-modern .dt{color:#10b981}
.pw.theme-classic{font-family:Georgia,serif}.pw.theme-classic .dh{border-bottom:2px double #1e293b}.pw.theme-classic th{background:#1e293b;color:#fff}
.pw.theme-minimal{font-family:'Helvetica Neue',Arial,sans-serif}.pw.theme-minimal .dh{border-bottom:1px solid #e2e8f0}.pw.theme-minimal .dt{font-weight:400;font-size:24px}
.pw.theme-bold .dh{background:#1e293b;color:#fff;padding:20px;border-radius:8px;border:none;margin:-60px -60px 30px;padding:40px 60px 20px}.pw.theme-bold .dt{color:#10b981;font-size:32px}.pw.theme-bold .ds2{color:#94a3b8}
.pw.theme-elegant{font-family:'Palatino Linotype',Palatino,serif}.pw.theme-elegant .dh{border-bottom:1px solid #c9a96e}.pw.theme-elegant .dt{color:#7c6228;letter-spacing:2px}.pw.theme-elegant th{background:#faf6ef;color:#7c6228;border-bottom:2px solid #c9a96e}
.pw.theme-corporate .dh{background:linear-gradient(135deg,#1e3a5f,#2563eb);color:#fff;padding:24px;margin:-60px -60px 30px;padding:40px 60px 20px;border:none}.pw.theme-corporate .dt{color:#fff}.pw.theme-corporate .ds2{color:#93c5fd}.pw.theme-corporate th{background:#1e3a5f;color:#fff}
</style>
</head>
<body>
<div class="hd">
<div class="lg"><div class="li">DP</div><div><h1>DocPro</h1><div class="st">Professional USA Document Generator</div></div></div>
<div class="gs"><span class="si">&#128269;</span><input type="text" id="globalSearch" placeholder="Search 10,000+ documents..." oninput="globalSearchFn(this.value)" onfocus="this.parentElement.querySelector('.sr').classList.add('open')" onblur="setTimeout(function(){document.querySelector('.sr').classList.remove('open')},200)"><div class="sr" id="searchResults"></div></div>
<div class="ac">
<span class="plan-badge plan-free" id="planBadge" onclick="openModal('pricingModal')">&#9889; Free Plan</span>
<button class="bt b3" onclick="openModal('logoModal')">&#127912; Logo</button>
<button class="bt b4" onclick="openModal('uploadModal')">&#128228; Upload</button>
<button class="bt b2" onclick="resetDoc()">&#8634; Reset</button>
<button class="bt b1" onclick="handlePrint()">&#128424; Print / PDF</button>
</div></div>
<div class="ap">
<div class="sb" id="sidebar"></div>
<div class="mn"><div class="pw" id="preview"></div><div class="lock-overlay" id="lockOverlay" style="display:none"></div></div>
</div>

<!-- Pricing Modal -->
<div class="modal-bg" id="pricingModal">
<div class="modal" style="max-width:800px">
<h2>&#128176; Choose Your Plan <button class="close-btn" onclick="closeModal('pricingModal')">&times;</button></h2>
<p style="color:var(--mt);margin-bottom:16px">Unlock premium document templates with professional designs</p>
<div class="pricing-grid">
<div class="price-card" onclick="setPlan('free')">
<h3 style="color:var(--ac)">&#9889; Free</h3>
<div class="pc-price">$0<span>/forever</span></div>
<p style="font-size:12px;color:var(--mt)">6,000+ templates</p>
<div class="pc-feat">
<div><span class="ck">&#10003;</span> Invoices, Receipts, Letters</div>
<div><span class="ck">&#10003;</span> Memos, Checklists, Reports</div>
<div><span class="ck">&#10003;</span> Resumes & Cover Letters</div>
<div><span class="ck">&#10003;</span> 6 Design Themes</div>
<div><span class="ck">&#10003;</span> Logo Studio</div>
<div><span class="ck">&#10003;</span> Print / Save PDF</div>
<div><span class="no">&#10007;</span> Contracts & Agreements</div>
<div><span class="no">&#10007;</span> Legal Documents</div>
</div>
<button class="bt b1" style="width:100%;justify-content:center;margin-top:8px" onclick="setPlan('free')">Current Plan</button>
</div>
<div class="price-card popular" onclick="setPlan('pro')">
<h3 style="color:var(--pro)">&#128142; Pro</h3>
<div class="pc-price" style="color:var(--pro)">$9<span>.99/mo</span></div>
<p style="font-size:12px;color:var(--mt)">8,500+ templates</p>
<div class="pc-feat">
<div><span class="ck">&#10003;</span> Everything in Free</div>
<div><span class="ck">&#10003;</span> Contracts & Proposals</div>
<div><span class="ck">&#10003;</span> Agreements & Certificates</div>
<div><span class="ck">&#10003;</span> Business Plans & Budgets</div>
<div><span class="ck">&#10003;</span> Offer Letters & Reviews</div>
<div><span class="ck">&#10003;</span> Priority Support</div>
<div><span class="no">&#10007;</span> NDAs & Legal Docs</div>
<div><span class="no">&#10007;</span> Power of Attorney</div>
</div>
<button class="bt b3" style="width:100%;justify-content:center;margin-top:8px" onclick="setPlan('pro')">Upgrade to Pro</button>
</div>
<div class="price-card" onclick="setPlan('business')">
<h3 style="color:var(--biz)">&#127775; Business</h3>
<div class="pc-price" style="color:var(--biz)">$24<span>.99/mo</span></div>
<p style="font-size:12px;color:var(--mt)">All 10,000+ templates</p>
<div class="pc-feat">
<div><span class="ck">&#10003;</span> Everything in Pro</div>
<div><span class="ck">&#10003;</span> NDAs & Non-Competes</div>
<div><span class="ck">&#10003;</span> Power of Attorney</div>
<div><span class="ck">&#10003;</span> Lease & Settlement</div>
<div><span class="ck">&#10003;</span> Wills & Deeds</div>
<div><span class="ck">&#10003;</span> All Legal Documents</div>
<div><span class="ck">&#10003;</span> Unlimited Everything</div>
<div><span class="ck">&#10003;</span> Premium Support</div>
</div>
<button class="bt b4" style="width:100%;justify-content:center;margin-top:8px" onclick="setPlan('business')">Upgrade to Business</button>
</div>
</div>
</div></div>

<!-- Logo Modal -->
<div class="modal-bg" id="logoModal">
<div class="modal">
<h2>&#127912; Logo Studio <button class="close-btn" onclick="closeModal('logoModal')">&times;</button></h2>
<div class="fg"><label>Search Logos & Icons</label><input type="text" id="logoSearchInput" placeholder="Search company logos, icons..." oninput="searchLogos(this.value)"></div>
<div id="logoSearchResults" class="logo-grid"></div>
<hr style="border-color:var(--bd);margin:16px 0">
<h3 style="font-size:14px;margin-bottom:10px">&#9999; Create Text Logo</h3>
<div class="fg"><label>Company Name</label><input type="text" id="logoText" placeholder="Your Company" oninput="updateLogoPreview()"></div>
<div style="display:flex;gap:8px">
<div class="fg" style="flex:1"><label>Font</label><select id="logoFont" onchange="updateLogoPreview()"><option value="Arial Black">Bold Sans</option><option value="Georgia">Serif</option><option value="Courier New">Monospace</option><option value="Impact">Impact</option><option value="Palatino">Elegant</option></select></div>
<div class="fg" style="flex:1"><label>Color</label><input type="color" id="logoColor" value="#10b981" onchange="updateLogoPreview()" style="height:32px;cursor:pointer"></div>
<div class="fg" style="flex:1"><label>Bg Color</label><input type="color" id="logoBg" value="#ffffff" onchange="updateLogoPreview()" style="height:32px;cursor:pointer"></div>
</div>
<div class="logo-prev" id="logoPreview">Your Logo</div>
<div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px"><button class="bt b2" onclick="closeModal('logoModal')">Cancel</button><button class="bt b1" onclick="applyLogo()">Apply Logo</button></div>
</div></div>

<!-- Upload Modal -->
<div class="modal-bg" id="uploadModal">
<div class="modal">
<h2>&#128228; Upload Document <button class="close-btn" onclick="closeModal('uploadModal')">&times;</button></h2>
<p style="color:var(--mt);font-size:13px;margin-bottom:12px">Upload a document to view, edit, or use as a starting point.</p>
<div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()" ondragover="event.preventDefault();this.classList.add('drag')" ondragleave="this.classList.remove('drag')" ondrop="handleDrop(event)">
<div style="font-size:48px;margin-bottom:8px">&#128196;</div>
<p style="font-size:14px;font-weight:600">Drop file here or click to browse</p>
<p style="font-size:12px;color:var(--mt);margin-top:4px">Supports: Images, PDF, TXT, HTML</p>
<input type="file" id="fileInput" style="display:none" accept=".pdf,.png,.jpg,.jpeg,.gif,.txt,.html" onchange="handleFileUpload(this.files[0])">
</div>
<div id="uploadPreview" style="display:none;margin-top:12px">
<div class="fg"><label>Extracted / Uploaded Content</label><textarea id="uploadContent" style="min-height:200px" oninput="renderUploadedDoc()"></textarea></div>
</div>
<div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px"><button class="bt b2" onclick="closeModal('uploadModal')">Cancel</button><button class="bt b1" onclick="applyUpload()">Use in Preview</button></div>
</div></div>
<script>
var SUPA_URL='https://mupeqeuuwdmkndvtbhzb.supabase.co';
var SUPA_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im11cGVxZXV1d2Rta25kdnRiaHpiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzNzkwNDMsImV4cCI6MjA4Njk1NTA0M30.aEixeQPtdXIxWUmCVXYba0G6x5Zs-2XRwt0gaA30ORk';

var CATS=[
{id:'business',n:'Business',i:'&#127970;',docs:[
{id:'invoice',n:'Invoice',i:'&#129534;',f:['companyName','companyAddr','phone','email','clientName','clientAddr','clientEmail','invoiceNum','invoiceDate','dueDate','i1d','i1q','i1p','i2d','i2q','i2p','i3d','i3q','i3p','notes','taxRate'],tier:1},
{id:'receipt',n:'Receipt',i:'&#129534;',f:['companyName','companyAddr','phone','email','clientName','receiptNum','receiptDate','payMethod','i1d','i1q','i1p','i2d','i2q','i2p','i3d','i3q','i3p','notes','taxRate'],tier:1},
{id:'proposal',n:'Business Proposal',i:'&#128203;',f:['companyName','companyAddr','phone','email','clientName','clientAddr','propDate','projTitle','projDesc','scope','timeline','budget','terms','notes'],tier:2},
{id:'po',n:'Purchase Order',i:'&#128722;',f:['companyName','companyAddr','phone','email','vendorName','vendorAddr','poNum','poDate','delivDate','i1d','i1q','i1p','i2d','i2q','i2p','i3d','i3q','i3p','shipMethod','notes'],tier:2},
{id:'bizLetter',n:'Business Letter',i:'&#9993;',f:['companyName','companyAddr','phone','email','recipName','recipTitle','recipCo','recipAddr','date','subject','body','closing','senderName','senderTitle'],tier:1},
{id:'memo',n:'Memo',i:'&#128221;',f:['companyName','mTo','mFrom','date','subject','body','cc'],tier:1},
{id:'minutes',n:'Meeting Minutes',i:'&#128203;',f:['companyName','meetTitle','date','time','location','attendees','agenda','discussion','decisions','actions','nextMeet'],tier:1}
]},
{id:'legal',n:'Legal',i:'&#9878;',docs:[
{id:'nda',n:'Non-Disclosure Agreement',i:'&#128274;',f:['p1Name','p1Addr','p2Name','p2Addr','effDate','purpose','duration','jurisdiction','confInfo','exclusions'],tier:3},
{id:'svcAgmt',n:'Service Agreement',i:'&#128196;',f:['provName','provAddr','clientName','clientAddr','effDate','services','compensation','payTerms','duration','termination','jurisdiction'],tier:2},
{id:'contractor',n:'Independent Contractor',i:'&#129489;',f:['companyName','companyAddr','contrName','contrAddr','effDate','services','compensation','paySchedule','duration','termination','nonCompete'],tier:2},
{id:'poa',n:'Power of Attorney',i:'&#128220;',f:['princName','princAddr','agentName','agentAddr','effDate','powers','limitations','duration','witnesses'],tier:3},
{id:'lease',n:'Lease Agreement',i:'&#127968;',f:['llName','llAddr','tenantName','tenantAddr','propAddr','leaseStart','leaseEnd','rent','deposit','utilities','rules','jurisdiction'],tier:3}
]},
{id:'financial',n:'Financial',i:'&#128176;',docs:[
{id:'expense',n:'Expense Report',i:'&#128180;',f:['empName','dept','mgrName','rptDate','period','e1Date','e1Desc','e1Cat','e1Amt','e2Date','e2Desc','e2Cat','e2Amt','e3Date','e3Desc','e3Cat','e3Amt','notes'],tier:1},
{id:'budget',n:'Budget Plan',i:'&#128200;',f:['companyName','dept','fiscalYr','prepBy','date','revenue','cogs','grossProfit','salaries','rent2','utilities','marketing','other','totalExp','netIncome','notes'],tier:2},
{id:'pnl',n:'Profit & Loss',i:'&#128202;',f:['companyName','period','revenue','cogs','grossProfit','salaries','rent2','utilities','marketing','depreciation','other','totalExp','netIncome','prepBy','date'],tier:2},
{id:'promNote',n:'Promissory Note',i:'&#128221;',f:['borName','borAddr','lendName','lendAddr','principal','intRate','issueDate','matDate','paySchedule','lateFee','jurisdiction'],tier:3}
]},
{id:'personal',n:'Personal',i:'&#128100;',docs:[
{id:'resume',n:'Resume / CV',i:'&#128196;',f:['fullName','address','phone','email','linkedin','objective','j1Title','j1Co','j1Dates','j1Desc','j2Title','j2Co','j2Dates','j2Desc','education','skills','certs'],tier:1},
{id:'coverLtr',n:'Cover Letter',i:'&#9993;',f:['fullName','address','phone','email','date','recipName','recipTitle','company','companyAddr2','position','body','closing'],tier:1},
{id:'persLtr',n:'Personal Letter',i:'&#128140;',f:['senderName','senderAddr','date','recipName','recipAddr','greeting','body','closing'],tier:1},
{id:'will',n:'Last Will & Testament',i:'&#128220;',f:['testName','testAddr','date','executor','execAddr','ben1','ben1Share','ben2','ben2Share','bequests','guardian','wit1','wit2','jurisdiction'],tier:3}
]},
{id:'hr',n:'HR / Employment',i:'&#128101;',docs:[
{id:'offer',n:'Offer Letter',i:'&#127881;',f:['companyName','companyAddr','candName','candAddr','date','position','dept','startDate','salary','benefits','manager','probation','conditions'],tier:2},
{id:'termination',n:'Termination Letter',i:'&#128683;',f:['companyName','companyAddr','empName','empAddr','date','position','termDate','reason','severance','benefits','returnItems','contact'],tier:3},
{id:'handbook',n:'Employee Handbook',i:'&#128214;',f:['companyName','ceoName','mission','values','workHrs','dressCode','pto','holidays','benefits','conduct','disciplinary','hrContact'],tier:2},
{id:'review',n:'Performance Review',i:'&#11088;',f:['empName','position','dept','revDate','revPeriod','reviewer','goals','achievements','strengths','improvements','rating','comments','nextGoals'],tier:2}
]},
{id:'realestate',n:'Real Estate',i:'&#127968;',docs:[
{id:'rentalApp',n:'Rental Application',i:'&#128196;',f:['appName','curAddr','phone','email','dob','employer','empPhone','income','prevLL','prevLLPhone','moveIn','emergContact','emergPhone'],tier:1},
{id:'eviction',n:'Eviction Notice',i:'&#9888;',f:['llName','llAddr','tenantName','tenantAddr','propAddr','date','reason','cureDate','amtOwed','moveOut','jurisdiction'],tier:3},
{id:'maint',n:'Maintenance Request',i:'&#128295;',f:['tenantName','unit','phone','email','date','urgency','category','description','prefDate','accessInstr','propMgr'],tier:1},
{id:'listing',n:'Property Listing',i:'&#127969;',f:['propAddr','price','propType','beds','baths','sqft','yrBuilt','lotSize','description','features','agentName','agentPhone','agentEmail'],tier:1}
]}
];
var FM={
companyName:'Company Name',companyAddr:'Company Address',phone:'Phone',email:'Email',clientName:'Client Name',clientAddr:'Client Address',clientEmail:'Client Email',
invoiceNum:'Invoice #',invoiceDate:'Invoice Date:date',dueDate:'Due Date:date',i1d:'Item 1 Description',i1q:'Qty:number',i1p:'Unit Price:number',
i2d:'Item 2 Description',i2q:'Qty:number',i2p:'Unit Price:number',i3d:'Item 3 Description',i3q:'Qty:number',i3p:'Unit Price:number',
notes:'Notes:textarea',taxRate:'Tax Rate %:number',receiptNum:'Receipt #',receiptDate:'Receipt Date:date',payMethod:'Payment Method',
propDate:'Proposal Date:date',projTitle:'Project Title',projDesc:'Project Description:textarea',scope:'Scope of Work:textarea',
timeline:'Timeline',budget:'Budget',terms:'Terms:textarea',vendorName:'Vendor Name',vendorAddr:'Vendor Address',
poNum:'PO Number',poDate:'PO Date:date',delivDate:'Delivery Date:date',shipMethod:'Shipping Method',
recipName:'Recipient Name',recipTitle:'Recipient Title',recipCo:'Recipient Company',recipAddr:'Recipient Address',
date:'Date:date',subject:'Subject',body:'Body:textarea',closing:'Closing',senderName:'Sender Name',senderTitle:'Sender Title',
mTo:'To',mFrom:'From',cc:'CC',meetTitle:'Meeting Title',time:'Time',location:'Location',attendees:'Attendees:textarea',
agenda:'Agenda:textarea',discussion:'Discussion:textarea',decisions:'Decisions:textarea',actions:'Action Items:textarea',nextMeet:'Next Meeting',
p1Name:'Party 1 Name',p1Addr:'Party 1 Address',p2Name:'Party 2 Name',p2Addr:'Party 2 Address',
effDate:'Effective Date:date',purpose:'Purpose:textarea',duration:'Duration',jurisdiction:'Jurisdiction',
confInfo:'Confidential Info:textarea',exclusions:'Exclusions:textarea',
provName:'Provider Name',provAddr:'Provider Address',services:'Services:textarea',compensation:'Compensation',payTerms:'Payment Terms',
termination:'Termination Terms:textarea',contrName:'Contractor Name',contrAddr:'Contractor Address',paySchedule:'Payment Schedule',
nonCompete:'Non-Compete:textarea',princName:'Principal Name',princAddr:'Principal Address',agentName:'Agent Name',agentAddr:'Agent Address',
powers:'Powers Granted:textarea',limitations:'Limitations:textarea',witnesses:'Witnesses',
llName:'Landlord Name',llAddr:'Landlord Address',tenantName:'Tenant Name',tenantAddr:'Tenant Address',
propAddr:'Property Address',leaseStart:'Lease Start:date',leaseEnd:'Lease End:date',rent:'Monthly Rent:number',
deposit:'Security Deposit:number',utilities:'Utilities',rules:'Rules:textarea',
empName:'Employee Name',dept:'Department',mgrName:'Manager Name',rptDate:'Report Date:date',period:'Period',
e1Date:'Item 1 Date:date',e1Desc:'Description',e1Cat:'Category',e1Amt:'Amount:number',
e2Date:'Item 2 Date:date',e2Desc:'Description',e2Cat:'Category',e2Amt:'Amount:number',
e3Date:'Item 3 Date:date',e3Desc:'Description',e3Cat:'Category',e3Amt:'Amount:number',
fiscalYr:'Fiscal Year',prepBy:'Prepared By',revenue:'Revenue:number',cogs:'COGS:number',grossProfit:'Gross Profit:number',
salaries:'Salaries:number',rent2:'Rent:number',marketing:'Marketing:number',depreciation:'Depreciation:number',
other:'Other:number',totalExp:'Total Expenses:number',netIncome:'Net Income:number',
borName:'Borrower Name',borAddr:'Borrower Address',lendName:'Lender Name',lendAddr:'Lender Address',
principal:'Principal Amount:number',intRate:'Interest Rate %:number',issueDate:'Issue Date:date',matDate:'Maturity Date:date',
lateFee:'Late Fee %:number',fullName:'Full Name',address:'Address',linkedin:'LinkedIn',
objective:'Objective:textarea',j1Title:'Job Title 1',j1Co:'Company 1',j1Dates:'Dates 1',j1Desc:'Description 1:textarea',
j2Title:'Job Title 2',j2Co:'Company 2',j2Dates:'Dates 2',j2Desc:'Description 2:textarea',
education:'Education:textarea',skills:'Skills:textarea',certs:'Certifications:textarea',
position:'Position',company:'Company',companyAddr2:'Company Address',greeting:'Greeting',
testName:'Testator Name',testAddr:'Testator Address',executor:'Executor Name',execAddr:'Executor Address',
ben1:'Beneficiary 1',ben1Share:'Share %:number',ben2:'Beneficiary 2',ben2Share:'Share %:number',
bequests:'Special Bequests:textarea',guardian:'Guardian for Minors',wit1:'Witness 1',wit2:'Witness 2',
candName:'Candidate Name',candAddr:'Candidate Address',startDate:'Start Date:date',salary:'Salary',
benefits:'Benefits:textarea',manager:'Reporting Manager',probation:'Probation Period',conditions:'Conditions:textarea',
termDate:'Termination Date:date',reason:'Reason:textarea',severance:'Severance:textarea',returnItems:'Items to Return:textarea',
contact:'Contact Person',ceoName:'CEO Name',mission:'Mission:textarea',values:'Core Values:textarea',
workHrs:'Work Hours',dressCode:'Dress Code',pto:'PTO Policy:textarea',holidays:'Holidays:textarea',
conduct:'Code of Conduct:textarea',disciplinary:'Disciplinary Policy:textarea',hrContact:'HR Contact',
revDate:'Review Date:date',revPeriod:'Review Period',reviewer:'Reviewer',goals:'Goals:textarea',
achievements:'Achievements:textarea',strengths:'Strengths:textarea',improvements:'Improvements:textarea',
rating:'Rating (1-5):number',comments:'Comments:textarea',nextGoals:'Next Goals:textarea',
appName:'Applicant Name',curAddr:'Current Address',dob:'Date of Birth:date',employer:'Employer',
empPhone:'Employer Phone',income:'Monthly Income:number',prevLL:'Previous Landlord',prevLLPhone:'Prev Landlord Phone',
moveIn:'Move-In Date:date',emergContact:'Emergency Contact',emergPhone:'Emergency Phone',
cureDate:'Cure By Date:date',amtOwed:'Amount Owed:number',moveOut:'Move-Out Date:date',
unit:'Unit Number',urgency:'Urgency',category:'Category',description:'Description:textarea',
prefDate:'Preferred Date:date',accessInstr:'Access Instructions:textarea',propMgr:'Property Manager',
price:'Listing Price:number',propType:'Property Type',beds:'Bedrooms:number',baths:'Bathrooms:number',
sqft:'Sq Ft:number',yrBuilt:'Year Built:number',lotSize:'Lot Size',features:'Features:textarea',
agentPhone:'Agent Phone',agentEmail:'Agent Email',senderAddr:'Sender Address',empAddr:'Employee Address'
};

var STYLES=[
{id:'modern',n:'Modern',color:'#10b981'},{id:'classic',n:'Classic',color:'#1e293b'},
{id:'minimal',n:'Minimal',color:'#64748b'},{id:'bold',n:'Bold',color:'#10b981'},
{id:'elegant',n:'Elegant',color:'#7c6228'},{id:'corporate',n:'Corporate',color:'#2563eb'}
];

var curCat=CATS[0],curDoc=CATS[0].docs[0],fv={},curStyle='modern',docLogo=null;
var docSearchTerm='',uploadedContent='',tierFilter='all';
var userPlan=localStorage.getItem('docpro_plan')||'free';

// Tier helpers
function tierName(t){return t===1?'Free':t===2?'Pro':t===3?'Business':'Free'}
function tierClass(t){return t===1?'tier-free':t===2?'tier-pro':'tier-biz'}
function canAccess(docTier){
  if(userPlan==='business')return true;
  if(userPlan==='pro')return docTier<=2;
  return docTier<=1;
}
function setPlan(p){userPlan=p;localStorage.setItem('docpro_plan',p);updatePlanBadge();closeModal('pricingModal');renderSidebar();renderPreview()}
function updatePlanBadge(){
  var b=document.getElementById('planBadge');
  if(userPlan==='pro'){b.className='plan-badge plan-pro';b.innerHTML='&#128142; Pro Plan'}
  else if(userPlan==='business'){b.className='plan-badge plan-biz';b.innerHTML='&#127775; Business Plan'}
  else{b.className='plan-badge plan-free';b.innerHTML='&#9889; Free Plan'}
}
function handlePrint(){
  if(!curDoc)return;
  var t=curDoc.tier||1;
  if(!canAccess(t)){openModal('pricingModal');return}
  window.print();
}
function gf(k){var s=FM[k]||k.replace(/([A-Z])/g,' $1').replace(/^./,function(x){return x.toUpperCase()});var p=s.split(':');return{label:p[0],type:p[1]||'text'}}

function renderSidebar(){
var sb=document.getElementById('sidebar'),h='<div class="st2">&#128194; Category</div><div class="cg">';
CATS.forEach(function(c){
  var cnt=c.docs?c.docs.length:0;
  h+='<div class="cc'+(c.id===curCat.id?' on':'')+'" onclick="selCat(\''+c.id+'\')"><span class="ic">'+c.i+'</span>'+c.n+(cnt?'<span class="badge">'+cnt+'</span>':'')+'</div>'
});
h+='</div>';
h+='<div class="st2">&#128196; Documents</div>';
h+='<div class="ds"><span style="color:var(--mt)">&#128269;</span><input type="text" id="docFilter" placeholder="Filter documents..." value="'+(docSearchTerm||'')+'" oninput="filterDocs(this.value)"></div>';
// Tier filter buttons
h+='<div class="tf-row">';
h+='<span class="tf-btn'+(tierFilter==='all'?' on':'')+'" onclick="setTierFilter(\'all\')">All</span>';
h+='<span class="tf-btn'+(tierFilter==='free'?' on':'')+'" onclick="setTierFilter(\'free\')">&#9889; Free</span>';
h+='<span class="tf-btn pro-f'+(tierFilter==='pro'?' on':'')+'" onclick="setTierFilter(\'pro\')">&#128142; Pro</span>';
h+='<span class="tf-btn biz-f'+(tierFilter==='biz'?' on':'')+'" onclick="setTierFilter(\'biz\')">&#127775; Biz</span>';
h+='</div>';
h+='<div class="dl" id="docList">';
var docs=curCat.docs||[];
if(docSearchTerm){docs=docs.filter(function(d){return d.n.toLowerCase().indexOf(docSearchTerm.toLowerCase())>=0})}
if(tierFilter==='free')docs=docs.filter(function(d){return(d.tier||1)===1});
else if(tierFilter==='pro')docs=docs.filter(function(d){return(d.tier||1)===2});
else if(tierFilter==='biz')docs=docs.filter(function(d){return(d.tier||1)===3});
docs.forEach(function(d){
  var t=d.tier||1;
  var locked=!canAccess(t);
  var tierTag=t===1?'<span class="vb tier-free">Free</span>':t===2?'<span class="vb tier-pro">Pro</span>':'<span class="vb tier-biz">Biz</span>';
  var vLabel=d.variant_label&&d.variant_label!=='Standard'?' ('+d.variant_label+')':'';
  h+='<div class="di'+(d.id===curDoc.id?' on':'')+'" onclick="selDoc(\''+d.id+'\')"><span>'+(d.i||'&#128196;')+'</span><span style="flex:1;font-size:12px">'+d.n+'</span>'+tierTag+(locked?'<span class="lock">&#128274;</span>':'')+'</div>';
});
if(!docs.length)h+='<div style="padding:16px;text-align:center;color:var(--mt);font-size:12px">No documents found</div>';
h+='</div>';
// Style picker
h+='<div class="st2" style="margin-top:12px">&#127912; Design Style</div><div class="vp">';
STYLES.forEach(function(s){h+='<span class="vt'+(s.id===curStyle?' on':'')+'" onclick="setStyle(\''+s.id+'\')">'+s.n+'</span>'});
h+='</div>';
// Fields
h+='<div class="st2" style="cursor:pointer;margin-top:10px" onclick="togF()">&#9999; Fields &#9660;</div><div id="fs">';
if(curDoc&&curDoc.f){
curDoc.f.forEach(function(k){var m=gf(k);h+='<div class="fg"><label>'+m.label+'</label>';
if(m.type==='textarea')h+='<textarea oninput="uf(\''+k+'\',this.value)">'+(fv[k]||'')+'</textarea>';
else h+='<input type="'+m.type+'" value="'+(fv[k]||'')+'" oninput="uf(\''+k+'\',this.value)">';
h+='</div>'});
}
h+='</div>';
sb.innerHTML=h;
}

function selCat(id){curCat=CATS.find(function(c){return c.id===id})||CATS[0];curDoc=curCat.docs[0]||{id:'',n:'',i:'',f:[]};fv={};docSearchTerm='';renderSidebar();renderPreview();document.getElementById('sidebar').scrollTop=0}
function selDoc(id){curDoc=curCat.docs.find(function(d){return d.id===id})||curCat.docs[0];fv={};renderSidebar();renderPreview()}
function uf(k,val){fv[k]=val;renderPreview()}
function togF(){var s=document.getElementById('fs');if(s)s.style.display=s.style.display==='none'?'block':'none'}
function resetDoc(){fv={};docLogo=null;renderSidebar();renderPreview()}
function filterDocs(val){docSearchTerm=val;renderSidebar()}
function setTierFilter(t){tierFilter=t;renderSidebar()}
function setStyle(id){curStyle=id;renderSidebar();renderPreview()}
function V(k){return fv[k]||''}
function $(n){return parseFloat(n||0).toFixed(2)}
function ci(){var items=[];for(var i=1;i<=3;i++){var d=V('i'+i+'d'),q=parseFloat(V('i'+i+'q'))||0,p=parseFloat(V('i'+i+'p'))||0;if(d)items.push({d:d,q:q,p:p,t:q*p})}var st=items.reduce(function(s,x){return s+x.t},0);var tx=st*(parseFloat(V('taxRate'))||0)/100;return{items:items,st:st,tx:tx,tot:st+tx}}

// Global search
function globalSearchFn(val){
var sr=document.getElementById('searchResults');
if(!val||val.length<2){sr.innerHTML='';sr.classList.remove('open');return}
var results=[];
CATS.forEach(function(c){c.docs.forEach(function(d){
  if(d.n.toLowerCase().indexOf(val.toLowerCase())>=0){results.push({cat:c,doc:d})}
})});
if(!results.length){sr.innerHTML='<div style="padding:16px;text-align:center;color:var(--mt);font-size:12px">No results for \"'+val+'\"</div>';sr.classList.add('open');return}
sr.innerHTML=results.slice(0,20).map(function(r){var t=r.doc.tier||1;return'<div class="ri" onclick="jumpToDoc(\''+r.cat.id+'\',\''+r.doc.id+'\')"><span>'+(r.doc.i||'&#128196;')+'</span><span>'+r.doc.n+'</span><span class="rc">'+r.cat.n+'</span><span class="tier-tag '+tierClass(t)+'">'+tierName(t)+'</span></div>'}).join('');
sr.classList.add('open');
}
function jumpToDoc(catId,docId){curCat=CATS.find(function(c){return c.id===catId});curDoc=curCat.docs.find(function(d){return d.id===docId});fv={};docSearchTerm='';document.getElementById('globalSearch').value='';document.getElementById('searchResults').classList.remove('open');renderSidebar();renderPreview()}

function openModal(id){document.getElementById(id).classList.add('open')}
function closeModal(id){document.getElementById(id).classList.remove('open')}

// Logo functions
function searchLogos(q){var el=document.getElementById('logoSearchResults');if(!q||q.length<2){el.innerHTML='';return}
var types=['initials','shapes','bottts','identicon','rings','thumbs'];var html='';
types.forEach(function(t){var url='https://api.dicebear.com/7.x/'+t+'/svg?seed='+encodeURIComponent(q)+'&size=64';html+='<div class="lg-item" onclick="selectSearchLogo(this,\''+url+'\')"><img src="'+url+'" alt="'+t+'"><span>'+t+'</span></div>'});
var colors=['#10b981','#2563eb','#ef4444','#f59e0b','#8b5cf6','#ec4899'];
colors.forEach(function(c,i){html+='<div class="lg-item" onclick="selectTextSearchLogo(\''+q+'\',\''+c+'\')"><div style="width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:'+c+';color:#fff;font-weight:700;font-size:14px;border-radius:8px;margin:0 auto">'+q.substring(0,3).toUpperCase()+'</div><span>'+['Green','Blue','Red','Amber','Purple','Pink'][i]+'</span></div>'});
el.innerHTML=html}
function selectSearchLogo(el,url){document.querySelectorAll('.lg-item').forEach(function(x){x.classList.remove('sel')});el.classList.add('sel');docLogo={type:'image',url:url}}
function selectTextSearchLogo(text,color){docLogo={type:'text',text:text,color:color,font:'Arial Black',bg:'#fff'};updateLogoPreview()}
function updateLogoPreview(){var prev=document.getElementById('logoPreview');var text=document.getElementById('logoText').value||'Your Logo';var font=document.getElementById('logoFont').value;var color=document.getElementById('logoColor').value;var bg=document.getElementById('logoBg').value;prev.style.fontFamily=font;prev.style.color=color;prev.style.background=bg;prev.textContent=text;docLogo={type:'text',text:text,color:color,font:font,bg:bg}}
function applyLogo(){closeModal('logoModal');renderPreview()}

// Upload functions
function handleDrop(e){e.preventDefault();document.getElementById('uploadZone').classList.remove('drag');if(e.dataTransfer.files.length)handleFileUpload(e.dataTransfer.files[0])}
function handleFileUpload(file){if(!file)return;document.getElementById('uploadPreview').style.display='block';
if(file.type.startsWith('text')||file.name.endsWith('.html')||file.name.endsWith('.txt')){var r=new FileReader();r.onload=function(e){document.getElementById('uploadContent').value=e.target.result;uploadedContent=e.target.result};r.readAsText(file)}
else if(file.type.startsWith('image')){var r=new FileReader();r.onload=function(e){uploadedContent='<img src="'+e.target.result+'" style="max-width:100%">';document.getElementById('uploadContent').value='[Image: '+file.name+']'};r.readAsDataURL(file)}
else{document.getElementById('uploadContent').value='[File: '+file.name+']\nPaste content here to edit.'}}
function renderUploadedDoc(){uploadedContent=document.getElementById('uploadContent').value}
function applyUpload(){closeModal('uploadModal');var el=document.getElementById('preview');el.className='pw theme-'+curStyle;
if(uploadedContent.indexOf('<img ')===0)el.innerHTML='<div class="dh"><div class="dt">UPLOADED DOCUMENT</div></div>'+uploadedContent;
else el.innerHTML='<div class="dh"><div class="dt">UPLOADED DOCUMENT</div></div><div style="white-space:pre-wrap;font-size:13px">'+uploadedContent.replace(/</g,'&lt;').replace(/>/g,'&gt;')+'</div>';
document.getElementById('lockOverlay').style.display='none'}
function logoHTML(){if(!docLogo)return'';if(docLogo.type==='image')return'<img class="doc-logo" src="'+docLogo.url+'" alt="Logo">';if(docLogo.type==='text')return'<div style="display:inline-block;padding:8px 16px;font-family:'+docLogo.font+';font-weight:700;font-size:20px;color:'+docLogo.color+';background:'+docLogo.bg+';border-radius:4px;margin-bottom:8px">'+docLogo.text+'</div>';return''}
function renderPreview(){
var el=document.getElementById('preview');var ov=document.getElementById('lockOverlay');
el.className='pw theme-'+curStyle;
var t=curDoc.tier||1;var locked=!canAccess(t);
if(locked)el.classList.add('locked');
var has=Object.values(fv).some(function(x){return x&&x.trim&&x.trim()!==''});
if(!has){el.innerHTML='<div class="pp"><div style="font-size:64px;margin-bottom:16px">'+(curDoc.i||'&#128196;')+'</div><h2>'+(curDoc.n||'Select a document')+'</h2><p style="margin-top:8px">&#8592; Fill in the fields to generate your document</p>'+(locked?'<div style="margin-top:16px"><span class="tier-tag '+tierClass(t)+'" style="font-size:12px;padding:4px 12px">'+tierName(t)+' Plan Required</span></div>':'')+'</div>';ov.style.display='none';return}
// Show lock overlay for premium docs
if(locked){
  var planNeeded=t===2?'Pro':'Business';
  var planPrice=t===2?'$9.99/mo':'$24.99/mo';
  ov.innerHTML='<h3>&#128274; '+planNeeded+' Plan Required</h3><p>This document requires a '+planNeeded+' subscription</p><div class="price">'+planPrice+'</div><button class="bt b5" style="width:100%;justify-content:center;font-size:14px;padding:12px" onclick="openModal(\'pricingModal\')">&#128142; Upgrade to '+planNeeded+'</button><p style="margin-top:8px;font-size:11px;color:var(--mt)">Preview shown above &mdash; upgrade to print/download</p>';
  ov.style.display='block';
}else{ov.style.display='none'}
var h='';switch(curDoc.id){
case'invoice':h=rInv();break;case'receipt':h=rRec();break;case'proposal':h=rProp();break;case'po':h=rPO();break;
case'bizLetter':h=rBizL();break;case'memo':h=rMemo();break;case'minutes':h=rMin();break;
case'nda':h=rNDA();break;case'svcAgmt':h=rSvc();break;case'contractor':h=rContr();break;case'poa':h=rPOA();break;case'lease':h=rLease();break;
case'expense':h=rExp();break;case'budget':h=rBudg();break;case'pnl':h=rPnL();break;case'promNote':h=rProm();break;
case'resume':h=rRes();break;case'coverLtr':h=rCov();break;case'persLtr':h=rPers();break;case'will':h=rWill();break;
case'offer':h=rOff();break;case'termination':h=rTerm();break;case'handbook':h=rHand();break;case'review':h=rRev();break;
case'rentalApp':h=rRent();break;case'eviction':h=rEvic();break;case'maint':h=rMaint();break;case'listing':h=rList();break;
default:h=rGen()}el.innerHTML=h}
function tblR(items){return items.map(function(i){return'<tr><td>'+i.d+'</td><td>'+i.q+'</td><td>$'+$(i.p)+'</td><td>$'+$(i.t)+'</td></tr>'}).join('')}
function rInv(){var c=ci();return logoHTML()+'<div class="dh"><div class="dt">INVOICE</div><div class="ds2">'+V('invoiceNum')+'</div></div><div class="ig"><div class="ib"><h4>From</h4><p><strong>'+V('companyName')+'</strong><br>'+V('companyAddr')+'<br>'+V('phone')+' | '+V('email')+'</p></div><div class="ib"><h4>Bill To</h4><p><strong>'+V('clientName')+'</strong><br>'+V('clientAddr')+'<br>'+V('clientEmail')+'</p></div></div><div class="ig"><div class="ib"><h4>Invoice Date</h4><p>'+V('invoiceDate')+'</p></div><div class="ib"><h4>Due Date</h4><p>'+V('dueDate')+'</p></div></div><table><thead><tr><th>Description</th><th>Qty</th><th>Unit Price</th><th>Total</th></tr></thead><tbody>'+tblR(c.items)+'</tbody></table><div class="tt"><div class="rw"><span>Subtotal:</span><span>$'+$(c.st)+'</span></div><div class="rw"><span>Tax ('+V('taxRate')+'%):</span><span>$'+$(c.tx)+'</span></div><div class="rw tf"><span>Total:</span><span>$'+$(c.tot)+'</span></div></div>'+(V('notes')?'<div class="nt"><h4>Notes</h4><p>'+V('notes')+'</p></div>':'')}
function rRec(){var c=ci();return logoHTML()+'<div class="dh"><div class="dt">RECEIPT</div><div class="ds2">'+V('receiptNum')+'</div></div><div class="ig"><div class="ib"><h4>From</h4><p><strong>'+V('companyName')+'</strong><br>'+V('companyAddr')+'<br>'+V('phone')+'</p></div><div class="ib"><h4>Received From</h4><p><strong>'+V('clientName')+'</strong><br>Date: '+V('receiptDate')+'<br>Payment: '+V('payMethod')+'</p></div></div><table><thead><tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr></thead><tbody>'+tblR(c.items)+'</tbody></table><div class="tt"><div class="rw"><span>Subtotal:</span><span>$'+$(c.st)+'</span></div><div class="rw"><span>Tax:</span><span>$'+$(c.tx)+'</span></div><div class="rw tf"><span>Total Paid:</span><span>$'+$(c.tot)+'</span></div></div>'+(V('notes')?'<div class="nt"><h4>Notes</h4><p>'+V('notes')+'</p></div>':'')}
function rProp(){return logoHTML()+'<div class="dh"><div class="dt">BUSINESS PROPOSAL</div><div class="ds2">'+V('projTitle')+'</div></div><div class="ig"><div class="ib"><h4>From</h4><p><strong>'+V('companyName')+'</strong><br>'+V('companyAddr')+'<br>'+V('phone')+' | '+V('email')+'</p></div><div class="ib"><h4>Prepared For</h4><p><strong>'+V('clientName')+'</strong><br>'+V('clientAddr')+'<br>Date: '+V('propDate')+'</p></div></div><h3 style="margin:20px 0 8px">Project Description</h3><p>'+V('projDesc')+'</p><h3 style="margin:20px 0 8px">Scope of Work</h3><p>'+V('scope')+'</p><div class="ig" style="margin-top:20px"><div class="ib"><h4>Timeline</h4><p>'+V('timeline')+'</p></div><div class="ib"><h4>Budget</h4><p>'+V('budget')+'</p></div></div>'+(V('terms')?'<h3 style="margin:20px 0 8px">Terms</h3><p>'+V('terms')+'</p>':'')+(V('notes')?'<div class="nt"><h4>Notes</h4><p>'+V('notes')+'</p></div>':'')+'<div class="sa"><div><div class="sl">Authorized Signature</div></div><div><div class="sl">Client Signature</div></div></div>'}
function rPO(){var c=ci();return logoHTML()+'<div class="dh"><div class="dt">PURCHASE ORDER</div><div class="ds2">'+V('poNum')+'</div></div><div class="ig"><div class="ib"><h4>From</h4><p><strong>'+V('companyName')+'</strong><br>'+V('companyAddr')+'</p></div><div class="ib"><h4>Vendor</h4><p><strong>'+V('vendorName')+'</strong><br>'+V('vendorAddr')+'</p></div></div><div class="ig"><div class="ib"><h4>PO Date</h4><p>'+V('poDate')+'</p></div><div class="ib"><h4>Delivery</h4><p>'+V('delivDate')+'</p></div></div><table><thead><tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr></thead><tbody>'+tblR(c.items)+'</tbody></table><div class="tt"><div class="rw tf"><span>Total:</span><span>$'+$(c.st)+'</span></div></div>'+(V('notes')?'<div class="nt"><h4>Notes</h4><p>'+V('notes')+'</p></div>':'')+'<div class="sa"><div><div class="sl">Authorized By</div></div><div><div class="sl">Vendor</div></div></div>'}
function rBizL(){return logoHTML()+'<div style="text-align:right;margin-bottom:30px"><p><strong>'+V('companyName')+'</strong><br>'+V('companyAddr')+'<br>'+V('phone')+'<br>'+V('email')+'</p><p style="margin-top:12px">'+V('date')+'</p></div><p>'+V('recipName')+'<br>'+V('recipTitle')+'<br>'+V('recipCo')+'<br>'+V('recipAddr')+'</p><p style="margin:24px 0"><strong>Re: '+V('subject')+'</strong></p><p>Dear '+V('recipName')+',</p><div style="margin:16px 0;white-space:pre-wrap">'+V('body')+'</div><p style="margin-top:24px">'+V('closing')+',</p><div class="sl" style="width:200px;margin-top:40px">'+V('senderName')+'<br>'+V('senderTitle')+'</div>'}
function rMemo(){return logoHTML()+'<div class="dh"><div class="dt">MEMORANDUM</div><div class="ds2">'+V('companyName')+'</div></div><div style="border-bottom:2px solid #e2e8f0;padding-bottom:16px;margin-bottom:20px"><p><strong>TO:</strong> '+V('mTo')+'</p><p><strong>FROM:</strong> '+V('mFrom')+'</p><p><strong>DATE:</strong> '+V('date')+'</p><p><strong>RE:</strong> '+V('subject')+'</p>'+(V('cc')?'<p><strong>CC:</strong> '+V('cc')+'</p>':'')+'</div><div style="white-space:pre-wrap">'+V('body')+'</div>'}
function rMin(){return logoHTML()+'<div class="dh"><div class="dt">MEETING MINUTES</div><div class="ds2">'+V('meetTitle')+'</div></div><div class="ig"><div class="ib"><h4>Organization</h4><p>'+V('companyName')+'</p></div><div class="ib"><h4>Date & Time</h4><p>'+V('date')+' at '+V('time')+'</p></div></div><div class="ig"><div class="ib"><h4>Location</h4><p>'+V('location')+'</p></div><div class="ib"><h4>Next Meeting</h4><p>'+V('nextMeet')+'</p></div></div><h3 style="margin:20px 0 8px">Attendees</h3><p>'+V('attendees')+'</p><h3 style="margin:20px 0 8px">Agenda</h3><div style="white-space:pre-wrap">'+V('agenda')+'</div><h3 style="margin:20px 0 8px">Discussion</h3><div style="white-space:pre-wrap">'+V('discussion')+'</div><h3 style="margin:20px 0 8px">Decisions</h3><div style="white-space:pre-wrap">'+V('decisions')+'</div><h3 style="margin:20px 0 8px">Action Items</h3><div style="white-space:pre-wrap">'+V('actions')+'</div>'}
function rNDA(){return logoHTML()+'<div class="dh"><div class="dt">NON-DISCLOSURE AGREEMENT</div></div><p>This NDA is entered into as of <strong>'+V('effDate')+'</strong> by and between:</p><div class="ig" style="margin:20px 0"><div class="ib"><h4>Disclosing Party</h4><p><strong>'+V('p1Name')+'</strong><br>'+V('p1Addr')+'</p></div><div class="ib"><h4>Receiving Party</h4><p><strong>'+V('p2Name')+'</strong><br>'+V('p2Addr')+'</p></div></div><h3 style="margin:20px 0 8px">Purpose</h3><p>'+V('purpose')+'</p><h3 style="margin:20px 0 8px">Confidential Information</h3><p>'+V('confInfo')+'</p>'+(V('exclusions')?'<h3 style="margin:20px 0 8px">Exclusions</h3><p>'+V('exclusions')+'</p>':'')+'<div class="ig"><div class="ib"><h4>Duration</h4><p>'+V('duration')+'</p></div><div class="ib"><h4>Governing Law</h4><p>'+V('jurisdiction')+'</p></div></div><div class="sa"><div><div class="sl">'+V('p1Name')+'</div></div><div><div class="sl">'+V('p2Name')+'</div></div></div>'}
function rSvc(){return logoHTML()+'<div class="dh"><div class="dt">SERVICE AGREEMENT</div></div><p>This Agreement is entered into as of <strong>'+V('effDate')+'</strong> between:</p><div class="ig" style="margin:20px 0"><div class="ib"><h4>Provider</h4><p><strong>'+V('provName')+'</strong><br>'+V('provAddr')+'</p></div><div class="ib"><h4>Client</h4><p><strong>'+V('clientName')+'</strong><br>'+V('clientAddr')+'</p></div></div><h3 style="margin:20px 0 8px">Services</h3><p>'+V('services')+'</p><div class="ig"><div class="ib"><h4>Compensation</h4><p>'+V('compensation')+'</p></div><div class="ib"><h4>Payment Terms</h4><p>'+V('payTerms')+'</p></div></div><div class="ig"><div class="ib"><h4>Duration</h4><p>'+V('duration')+'</p></div><div class="ib"><h4>Jurisdiction</h4><p>'+V('jurisdiction')+'</p></div></div><h3 style="margin:20px 0 8px">Termination</h3><p>'+V('termination')+'</p><div class="sa"><div><div class="sl">'+V('provName')+'</div></div><div><div class="sl">'+V('clientName')+'</div></div></div>'}
function rContr(){return logoHTML()+'<div class="dh"><div class="dt">INDEPENDENT CONTRACTOR AGREEMENT</div></div><p>Agreement entered <strong>'+V('effDate')+'</strong> between:</p><div class="ig" style="margin:20px 0"><div class="ib"><h4>Company</h4><p><strong>'+V('companyName')+'</strong><br>'+V('companyAddr')+'</p></div><div class="ib"><h4>Contractor</h4><p><strong>'+V('contrName')+'</strong><br>'+V('contrAddr')+'</p></div></div><h3 style="margin:20px 0 8px">Services</h3><p>'+V('services')+'</p><div class="ig"><div class="ib"><h4>Compensation</h4><p>'+V('compensation')+'</p></div><div class="ib"><h4>Payment</h4><p>'+V('paySchedule')+'</p></div></div><p><strong>Duration:</strong> '+V('duration')+'</p><h3 style="margin:20px 0 8px">Termination</h3><p>'+V('termination')+'</p>'+(V('nonCompete')?'<h3 style="margin:20px 0 8px">Non-Compete</h3><p>'+V('nonCompete')+'</p>':'')+'<div class="sa"><div><div class="sl">'+V('companyName')+'</div></div><div><div class="sl">'+V('contrName')+'</div></div></div>'}
function rPOA(){return logoHTML()+'<div class="dh"><div class="dt">POWER OF ATTORNEY</div></div><p>I, <strong>'+V('princName')+'</strong>, residing at '+V('princAddr')+', appoint:</p><p style="margin:16px 0;padding:16px;background:#f8fafc;border-radius:8px"><strong>'+V('agentName')+'</strong><br>'+V('agentAddr')+'</p><p>as my Attorney-in-Fact, effective <strong>'+V('effDate')+'</strong>.</p><h3 style="margin:20px 0 8px">Powers</h3><div style="white-space:pre-wrap">'+V('powers')+'</div>'+(V('limitations')?'<h3 style="margin:20px 0 8px">Limitations</h3><p>'+V('limitations')+'</p>':'')+'<p><strong>Duration:</strong> '+V('duration')+'</p><div class="sa"><div><div class="sl">'+V('princName')+'<br>Principal</div></div><div><div class="sl">Witness: '+V('witnesses')+'</div></div></div>'}
function rLease(){return logoHTML()+'<div class="dh"><div class="dt">LEASE AGREEMENT</div></div><div class="ig"><div class="ib"><h4>Landlord</h4><p><strong>'+V('llName')+'</strong><br>'+V('llAddr')+'</p></div><div class="ib"><h4>Tenant</h4><p><strong>'+V('tenantName')+'</strong><br>'+V('tenantAddr')+'</p></div></div><p style="margin:16px 0;padding:16px;background:#f8fafc;border-radius:8px"><strong>Property:</strong> '+V('propAddr')+'</p><div class="ig"><div class="ib"><h4>Start</h4><p>'+V('leaseStart')+'</p></div><div class="ib"><h4>End</h4><p>'+V('leaseEnd')+'</p></div></div><div class="ig"><div class="ib"><h4>Rent</h4><p>$'+$(V('rent'))+'</p></div><div class="ib"><h4>Deposit</h4><p>$'+$(V('deposit'))+'</p></div></div><p><strong>Utilities:</strong> '+V('utilities')+'</p>'+(V('rules')?'<h3 style="margin:20px 0 8px">Rules</h3><p>'+V('rules')+'</p>':'')+'<p><strong>Jurisdiction:</strong> '+V('jurisdiction')+'</p><div class="sa"><div><div class="sl">'+V('llName')+'<br>Landlord</div></div><div><div class="sl">'+V('tenantName')+'<br>Tenant</div></div></div>'}
function rExp(){var items=[];for(var i=1;i<=3;i++){var d=V('e'+i+'Date'),desc=V('e'+i+'Desc'),cat=V('e'+i+'Cat'),amt=parseFloat(V('e'+i+'Amt'))||0;if(desc)items.push({d:d,desc:desc,cat:cat,amt:amt})}var tot=items.reduce(function(s,x){return s+x.amt},0);return logoHTML()+'<div class="dh"><div class="dt">EXPENSE REPORT</div></div><div class="ig"><div class="ib"><h4>Employee</h4><p><strong>'+V('empName')+'</strong><br>'+V('dept')+'</p></div><div class="ib"><h4>Details</h4><p>Manager: '+V('mgrName')+'<br>Date: '+V('rptDate')+'<br>Period: '+V('period')+'</p></div></div><table><thead><tr><th>Date</th><th>Description</th><th>Category</th><th>Amount</th></tr></thead><tbody>'+items.map(function(i){return'<tr><td>'+i.d+'</td><td>'+i.desc+'</td><td>'+i.cat+'</td><td>$'+$(i.amt)+'</td></tr>'}).join('')+'</tbody></table><div class="tt"><div class="rw tf"><span>Total:</span><span>$'+$(tot)+'</span></div></div>'+(V('notes')?'<div class="nt"><h4>Notes</h4><p>'+V('notes')+'</p></div>':'')+'<div class="sa"><div><div class="sl">Employee</div></div><div><div class="sl">Manager Approval</div></div></div>'}
function rBudg(){return logoHTML()+'<div class="dh"><div class="dt">BUDGET PLAN</div><div class="ds2">'+V('companyName')+' - FY '+V('fiscalYr')+'</div></div><div class="ig"><div class="ib"><h4>Department</h4><p>'+V('dept')+'</p></div><div class="ib"><h4>Prepared By</h4><p>'+V('prepBy')+' | '+V('date')+'</p></div></div><table><thead><tr><th>Category</th><th>Amount</th></tr></thead><tbody><tr><td><strong>Revenue</strong></td><td>$'+$(V('revenue'))+'</td></tr><tr><td>COGS</td><td>($'+$(V('cogs'))+')</td></tr><tr style="background:#f0fdf4"><td><strong>Gross Profit</strong></td><td><strong>$'+$(V('grossProfit'))+'</strong></td></tr><tr><td>Salaries</td><td>$'+$(V('salaries'))+'</td></tr><tr><td>Rent</td><td>$'+$(V('rent2'))+'</td></tr><tr><td>Utilities</td><td>$'+$(V('utilities'))+'</td></tr><tr><td>Marketing</td><td>$'+$(V('marketing'))+'</td></tr><tr><td>Other</td><td>$'+$(V('other'))+'</td></tr><tr style="background:#fef2f2"><td><strong>Total Expenses</strong></td><td><strong>$'+$(V('totalExp'))+'</strong></td></tr><tr style="background:#f0f9ff"><td><strong>Net Income</strong></td><td><strong>$'+$(V('netIncome'))+'</strong></td></tr></tbody></table>'+(V('notes')?'<div class="nt"><h4>Notes</h4><p>'+V('notes')+'</p></div>':'')}
function rPnL(){return logoHTML()+'<div class="dh"><div class="dt">PROFIT & LOSS</div><div class="ds2">'+V('companyName')+' | '+V('period')+'</div></div><table><thead><tr><th>Item</th><th>Amount</th></tr></thead><tbody><tr><td><strong>Revenue</strong></td><td>$'+$(V('revenue'))+'</td></tr><tr><td>COGS</td><td>($'+$(V('cogs'))+')</td></tr><tr style="background:#f0fdf4"><td><strong>Gross Profit</strong></td><td><strong>$'+$(V('grossProfit'))+'</strong></td></tr><tr><td>Salaries</td><td>$'+$(V('salaries'))+'</td></tr><tr><td>Rent</td><td>$'+$(V('rent2'))+'</td></tr><tr><td>Marketing</td><td>$'+$(V('marketing'))+'</td></tr><tr><td>Depreciation</td><td>$'+$(V('depreciation'))+'</td></tr><tr><td>Other</td><td>$'+$(V('other'))+'</td></tr><tr style="background:#fef2f2"><td><strong>Total Expenses</strong></td><td><strong>$'+$(V('totalExp'))+'</strong></td></tr><tr style="background:#f0f9ff"><td><strong>Net Income</strong></td><td><strong>$'+$(V('netIncome'))+'</strong></td></tr></tbody></table><p style="margin-top:16px;color:#64748b">Prepared by '+V('prepBy')+' on '+V('date')+'</p>'}
function rProm(){return logoHTML()+'<div class="dh"><div class="dt">PROMISSORY NOTE</div></div><p><strong>'+V('borName')+'</strong> promises to pay <strong>'+V('lendName')+'</strong> $'+$(V('principal'))+'.</p><div class="ig" style="margin:20px 0"><div class="ib"><h4>Interest Rate</h4><p>'+V('intRate')+'% per annum</p></div><div class="ib"><h4>Issue Date</h4><p>'+V('issueDate')+'</p></div></div><div class="ig"><div class="ib"><h4>Maturity</h4><p>'+V('matDate')+'</p></div><div class="ib"><h4>Payment</h4><p>'+V('paySchedule')+'</p></div></div><p><strong>Late Fee:</strong> '+V('lateFee')+'%</p><p><strong>Jurisdiction:</strong> '+V('jurisdiction')+'</p><div class="sa"><div><div class="sl">'+V('borName')+'<br>Borrower</div></div><div><div class="sl">'+V('lendName')+'<br>Lender</div></div></div>'}
function rRes(){return'<div style="text-align:center;margin-bottom:24px">'+logoHTML()+'<h2 style="font-size:28px">'+V('fullName')+'</h2><p style="color:#64748b">'+[V('address'),V('phone'),V('email'),V('linkedin')].filter(Boolean).join(' | ')+'</p></div>'+(V('objective')?'<h3 style="border-bottom:2px solid #1e293b;padding-bottom:4px;margin:20px 0 8px">OBJECTIVE</h3><p>'+V('objective')+'</p>':'')+'<h3 style="border-bottom:2px solid #1e293b;padding-bottom:4px;margin:20px 0 8px">EXPERIENCE</h3>'+(V('j1Title')?'<p><strong>'+V('j1Title')+'</strong> at '+V('j1Co')+' <span style="color:#64748b">('+V('j1Dates')+')</span></p><p style="margin:4px 0 12px">'+V('j1Desc')+'</p>':'')+(V('j2Title')?'<p><strong>'+V('j2Title')+'</strong> at '+V('j2Co')+' <span style="color:#64748b">('+V('j2Dates')+')</span></p><p style="margin:4px 0 12px">'+V('j2Desc')+'</p>':'')+(V('education')?'<h3 style="border-bottom:2px solid #1e293b;padding-bottom:4px;margin:20px 0 8px">EDUCATION</h3><p>'+V('education')+'</p>':'')+(V('skills')?'<h3 style="border-bottom:2px solid #1e293b;padding-bottom:4px;margin:20px 0 8px">SKILLS</h3><p>'+V('skills')+'</p>':'')+(V('certs')?'<h3 style="border-bottom:2px solid #1e293b;padding-bottom:4px;margin:20px 0 8px">CERTIFICATIONS</h3><p>'+V('certs')+'</p>':'')}
function rCov(){return logoHTML()+'<p>'+V('fullName')+'<br>'+V('address')+'<br>'+V('phone')+' | '+V('email')+'</p><p style="margin-top:16px">'+V('date')+'</p><p style="margin:16px 0">'+V('recipName')+'<br>'+V('recipTitle')+'<br>'+V('company')+'<br>'+V('companyAddr2')+'</p><p>Dear '+V('recipName')+',</p><p style="margin:16px 0"><strong>Re: '+V('position')+'</strong></p><div style="white-space:pre-wrap">'+V('body')+'</div><p style="margin-top:24px">'+V('closing')+',</p><p style="margin-top:20px"><strong>'+V('fullName')+'</strong></p>'}
function rPers(){return logoHTML()+'<div style="text-align:right;margin-bottom:30px"><p>'+V('senderName')+'<br>'+V('senderAddr')+'</p><p style="margin-top:8px">'+V('date')+'</p></div><p>'+V('recipName')+'<br>'+V('recipAddr')+'</p><p style="margin:20px 0">'+(V('greeting')||'Dear '+V('recipName'))+',</p><div style="white-space:pre-wrap">'+V('body')+'</div><p style="margin-top:24px">'+V('closing')+',</p><p style="margin-top:20px">'+V('senderName')+'</p>'}
function rWill(){return logoHTML()+'<div class="dh"><div class="dt">LAST WILL AND TESTAMENT</div><div class="ds2">of '+V('testName')+'</div></div><p>I, <strong>'+V('testName')+'</strong>, of '+V('testAddr')+', being of sound mind, declare this my Last Will on <strong>'+V('date')+'</strong>.</p><h3 style="margin:20px 0 8px">EXECUTOR</h3><p><strong>'+V('executor')+'</strong>, '+V('execAddr')+'</p><h3 style="margin:20px 0 8px">BENEFICIARIES</h3><table><thead><tr><th>Beneficiary</th><th>Share</th></tr></thead><tbody>'+(V('ben1')?'<tr><td>'+V('ben1')+'</td><td>'+V('ben1Share')+'%</td></tr>':'')+(V('ben2')?'<tr><td>'+V('ben2')+'</td><td>'+V('ben2Share')+'%</td></tr>':'')+'</tbody></table>'+(V('bequests')?'<h3 style="margin:20px 0 8px">SPECIAL BEQUESTS</h3><p>'+V('bequests')+'</p>':'')+(V('guardian')?'<h3 style="margin:20px 0 8px">GUARDIAN</h3><p>'+V('guardian')+'</p>':'')+'<p><strong>Jurisdiction:</strong> '+V('jurisdiction')+'</p><div class="sa"><div><div class="sl">'+V('testName')+'<br>Testator</div></div><div><div class="sl">Witness: '+V('wit1')+'</div></div></div><div style="margin-top:20px"><div class="sl" style="width:300px">Witness: '+V('wit2')+'</div></div>'}
function rOff(){return logoHTML()+'<div class="dh"><div class="dt">OFFER LETTER</div><div class="ds2">'+V('companyName')+'</div></div><p style="text-align:right">'+V('date')+'</p><p>'+V('candName')+'<br>'+V('candAddr')+'</p><p style="margin:20px 0">Dear '+V('candName')+',</p><p>We offer you the position of <strong>'+V('position')+'</strong> in <strong>'+V('dept')+'</strong>.</p><div class="ig" style="margin:20px 0"><div class="ib"><h4>Start Date</h4><p>'+V('startDate')+'</p></div><div class="ib"><h4>Salary</h4><p>'+V('salary')+'</p></div></div><div class="ig"><div class="ib"><h4>Manager</h4><p>'+V('manager')+'</p></div><div class="ib"><h4>Probation</h4><p>'+V('probation')+'</p></div></div>'+(V('benefits')?'<h3 style="margin:20px 0 8px">Benefits</h3><p>'+V('benefits')+'</p>':'')+(V('conditions')?'<h3 style="margin:20px 0 8px">Conditions</h3><p>'+V('conditions')+'</p>':'')+'<div class="sa"><div><div class="sl">'+V('companyName')+'</div></div><div><div class="sl">'+V('candName')+'<br>Acceptance</div></div></div>'}
function rTerm(){return logoHTML()+'<div class="dh"><div class="dt">TERMINATION LETTER</div><div class="ds2">'+V('companyName')+'</div></div><p style="text-align:right">'+V('date')+'</p><p>'+V('empName')+'<br>'+V('empAddr')+'</p><p style="margin:20px 0">Dear '+V('empName')+',</p><p>Your employment as <strong>'+V('position')+'</strong> is terminated effective <strong>'+V('termDate')+'</strong>.</p><h3 style="margin:20px 0 8px">Reason</h3><p>'+V('reason')+'</p>'+(V('severance')?'<h3 style="margin:20px 0 8px">Severance</h3><p>'+V('severance')+'</p>':'')+'<p style="margin-top:16px">Contact: <strong>'+V('contact')+'</strong></p><div style="margin-top:40px"><div class="sl" style="width:300px">Authorized Representative</div></div>'}
function rHand(){return logoHTML()+'<div class="dh"><div class="dt">EMPLOYEE HANDBOOK</div><div class="ds2">'+V('companyName')+'</div></div><div class="nt" style="margin-bottom:20px"><h4>Welcome from '+V('ceoName')+'</h4><p>Welcome to '+V('companyName')+'!</p></div>'+(V('mission')?'<h3 style="margin:20px 0 8px">Mission</h3><p>'+V('mission')+'</p>':'')+(V('values')?'<h3 style="margin:20px 0 8px">Values</h3><p>'+V('values')+'</p>':'')+'<h3 style="margin:20px 0 8px">Work Hours</h3><p>'+V('workHrs')+'</p><h3 style="margin:20px 0 8px">Dress Code</h3><p>'+V('dressCode')+'</p>'+(V('pto')?'<h3 style="margin:20px 0 8px">PTO</h3><p>'+V('pto')+'</p>':'')+'<p style="margin-top:20px;color:#64748b">HR: '+V('hrContact')+'</p>'}
function rRev(){return logoHTML()+'<div class="dh"><div class="dt">PERFORMANCE REVIEW</div></div><div class="ig"><div class="ib"><h4>Employee</h4><p><strong>'+V('empName')+'</strong><br>'+V('position')+' | '+V('dept')+'</p></div><div class="ib"><h4>Review</h4><p>'+V('revDate')+'<br>Period: '+V('revPeriod')+'<br>Reviewer: '+V('reviewer')+'</p></div></div>'+(V('goals')?'<h3 style="margin:20px 0 8px">Goals</h3><p>'+V('goals')+'</p>':'')+(V('achievements')?'<h3 style="margin:20px 0 8px">Achievements</h3><p>'+V('achievements')+'</p>':'')+(V('rating')?'<div style="margin:20px 0;padding:16px;background:#f0f9ff;border-radius:8px;text-align:center"><h4>Rating</h4><p style="font-size:32px;font-weight:700">'+V('rating')+' / 5</p></div>':'')+'<div class="sa"><div><div class="sl">Employee</div></div><div><div class="sl">Reviewer</div></div></div>'}
function rRent(){return logoHTML()+'<div class="dh"><div class="dt">RENTAL APPLICATION</div></div><div class="ig"><div class="ib"><h4>Applicant</h4><p><strong>'+V('appName')+'</strong><br>'+V('curAddr')+'<br>'+V('phone')+' | '+V('email')+'</p></div><div class="ib"><h4>Personal</h4><p>DOB: '+V('dob')+'</p></div></div><h3 style="margin:20px 0 8px">Employment</h3><div class="ig"><div class="ib"><h4>Employer</h4><p>'+V('employer')+'</p></div><div class="ib"><h4>Income</h4><p>$'+$(V('income'))+'/mo</p></div></div><p><strong>Move-In:</strong> '+V('moveIn')+'</p><div style="margin-top:40px"><div class="sl" style="width:300px">Applicant Signature</div></div>'}
function rEvic(){return logoHTML()+'<div class="dh"><div class="dt">NOTICE TO VACATE</div></div><p style="text-align:right">'+V('date')+'</p><div class="ig"><div class="ib"><h4>Landlord</h4><p><strong>'+V('llName')+'</strong><br>'+V('llAddr')+'</p></div><div class="ib"><h4>Tenant</h4><p><strong>'+V('tenantName')+'</strong><br>'+V('tenantAddr')+'</p></div></div><p style="margin:16px 0;padding:16px;background:#fef2f2;border-radius:8px;border-left:4px solid #ef4444"><strong>Property:</strong> '+V('propAddr')+'</p><h3 style="margin:20px 0 8px">Reason</h3><p>'+V('reason')+'</p>'+(V('amtOwed')?'<p><strong>Owed:</strong> $'+$(V('amtOwed'))+'</p>':'')+'<div class="ig" style="margin:20px 0"><div class="ib"><h4>Cure By</h4><p>'+V('cureDate')+'</p></div><div class="ib"><h4>Move Out</h4><p>'+V('moveOut')+'</p></div></div><div style="margin-top:40px"><div class="sl" style="width:300px">'+V('llName')+'</div></div>'}
function rMaint(){return logoHTML()+'<div class="dh"><div class="dt">MAINTENANCE REQUEST</div></div><div class="ig"><div class="ib"><h4>Tenant</h4><p><strong>'+V('tenantName')+'</strong><br>Unit '+V('unit')+'<br>'+V('phone')+'</p></div><div class="ib"><h4>Details</h4><p>Date: '+V('date')+'<br>Urgency: <strong>'+V('urgency')+'</strong><br>Category: '+V('category')+'</p></div></div><h3 style="margin:20px 0 8px">Description</h3><div style="white-space:pre-wrap;padding:16px;background:#f8fafc;border-radius:8px">'+V('description')+'</div><div style="margin-top:40px"><div class="sl" style="width:300px">Tenant Signature</div></div>'}
function rList(){return logoHTML()+'<div class="dh"><div class="dt">PROPERTY LISTING</div><div class="ds2">'+V('propAddr')+'</div></div><div style="text-align:center;font-size:32px;font-weight:700;color:#10b981;margin:16px 0">$'+Number(V('price')||0).toLocaleString()+'</div><div class="ig"><div class="ib"><h4>Type</h4><p>'+V('propType')+'</p></div><div class="ib"><h4>Built</h4><p>'+V('yrBuilt')+'</p></div></div><div class="ig"><div class="ib"><h4>Beds</h4><p>'+V('beds')+'</p></div><div class="ib"><h4>Baths</h4><p>'+V('baths')+'</p></div></div><h3 style="margin:20px 0 8px">Description</h3><p>'+V('description')+'</p>'+(V('features')?'<h3 style="margin:20px 0 8px">Features</h3><p>'+V('features')+'</p>':'')+'<div style="margin-top:24px;padding:16px;background:#f0f9ff;border-radius:8px"><h4>Agent</h4><p><strong>'+V('agentName')+'</strong><br>'+V('agentPhone')+' | '+V('agentEmail')+'</p></div>'}
function rGen(){var h=logoHTML()+'<div class="dh"><div class="dt">'+(curDoc.n||'Document').toUpperCase()+'</div></div>';if(curDoc.f){curDoc.f.forEach(function(k){if(V(k)){var m=gf(k);h+='<div class="ib" style="margin-bottom:12px"><h4>'+m.label+'</h4><p>'+V(k)+'</p></div>'}})}h+='<div class="sa"><div><div class="sl">Signature</div></div><div><div class="sl">Date</div></div></div>';return h}

// Initialize
updatePlanBadge();renderSidebar();renderPreview();

// Supabase Integration - Load ALL templates with pagination
function loadFromSupabase(){
var headers={'apikey':SUPA_KEY,'Authorization':'Bearer '+SUPA_KEY};
fetch(SUPA_URL+'/rest/v1/categories?select=*&order=sort_order',{headers:headers})
.then(function(r){return r.json()}).then(function(cats){
  if(!cats.length)return;
  var allTemplates=[];var pageSize=1000;
  function fetchPage(offset){
    return fetch(SUPA_URL+'/rest/v1/document_templates?select=*&order=name&offset='+offset+'&limit='+pageSize,{headers:headers})
    .then(function(r){return r.json()}).then(function(docs){
      allTemplates=allTemplates.concat(docs);
      if(docs.length===pageSize){return fetchPage(offset+pageSize)}
      return allTemplates;
    });
  }
  fetchPage(0).then(function(docs){
    if(docs.length){
      CATS=cats.map(function(c){
        return{id:c.id,n:c.name,i:c.icon,docs:docs.filter(function(d){return d.category_id===c.id}).map(function(d){
          return{id:d.id,n:d.name,i:d.icon||'&#128196;',f:d.fields||[],tier:d.tier||1,variant:d.variant,variant_label:d.variant_label,description:d.description}
        })}
      });
      curCat=CATS[0];curDoc=CATS[0].docs[0]||{id:'',n:'',i:'',f:[],tier:1};fv={};
      renderSidebar();renderPreview();
      console.log('DocPro: Loaded '+docs.length+' templates from Supabase across '+cats.length+' categories');
    }
  }).catch(function(e){console.log('DocPro: Pagination error',e)});
}).catch(function(e){console.log('DocPro: Using local data',e)});
}
loadFromSupabase();
</script>
</body>
</html>
